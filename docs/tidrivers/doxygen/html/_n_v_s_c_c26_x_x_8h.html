<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>NVSCC26XX.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="tiapistylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="100%">
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border="0" src="tilogo.gif" /></a></td>
  <td bgcolor="red"><img src="titagline.gif" /></td>
</tr>
</table>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2298ed0e5bfee6f293aea6c715ac7f7c.html">exports</a></li><li class="navelem"><a class="el" href="dir_3b541eea6259595923e49fb49c6b8bf6.html">tidrivers_cc13xx_cc26xx_3_30_03_00</a></li><li class="navelem"><a class="el" href="dir_79a6a61e2229792d5e8f66f7bdbf7543.html">source</a></li><li class="navelem"><a class="el" href="dir_a0a008e4586023d1120bd251d0c07733.html">ti</a></li><li class="navelem"><a class="el" href="dir_d0671196ce735ce071f605df95eeb992.html">drivers</a></li><li class="navelem"><a class="el" href="dir_94a8c0941d4c402501175ec2a70f8299.html">nvs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">NVSCC26XX.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Non-Volatile Storage driver for CC13XX/CC26XX devices. </p>
<p>============================================================================</p>
<h3>Interrupt Latency During Flash Operations</h3>
<p>When writing to or erasing flash, interrupts must be disabled to avoid executing code in flash while the flash is being reprogrammed. This constraint is met internally by the driver. User code does not need to safeguard against this.</p>
<p>Additionally, to avoid extremely large interrupt latencies that would be incurred if entire blocks were written with interrupts disabled, block writes to flash are broken into multiple smaller sizes.</p>
<p>Even with this scheme in place, latencies of roughly 64 microseconds will be incurred while flash is being written to.</p>
<p>A similar caveat applies to flash erase operations. Erasing an entire flash sector (the minimal amount that can be erased at a time) can take roughly 8 milliseconds. This entire operation must be performed with interrupts disabled. Here again, this requirement is met internally by the driver and flash region erases are performed one sector at a time to minimize this significant latency.impact.</p>
<p>Care must be taken by the user to not perform flash write or erase operations during latency critical phases of an application. See the <a class="el" href="_n_v_s_8h.html#a62d1593df9acb6d3c6446f1719f3bf28" title="Function to lock the NVS driver. ">NVS_lock()</a> and <a class="el" href="_n_v_s_8h.html#a01fb843c26ca406c5c9463eae6b0b817" title="Function to unlock the NVS driver. ">NVS_unlock()</a> API descriptions for more information. </p><hr/>
</div><div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div>
<p><a href="_n_v_s_c_c26_x_x_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_n_v_s_c_c26_x_x___h_w_attrs.html">NVSCC26XX_HWAttrs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">NVSCC26XX attributes.  <a href="struct_n_v_s_c_c26_x_x___h_w_attrs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_n_v_s_c_c26_x_x___object.html">NVSCC26XX_Object</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa21de44fea696d5e49503a7e0d9a00b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_n_v_s_c_c26_x_x_8h.html#aa21de44fea696d5e49503a7e0d9a00b7">NVSCC26XX_STATUS_LOW_VOLTAGE</a>&#160;&#160;&#160;(<a class="el" href="group___n_v_s___c_o_n_t_r_o_l.html#gad82fd139152ca14946c80c6c91edb4a0">NVS_STATUS_RESERVED</a> - 1)</td></tr>
<tr class="memdesc:aa21de44fea696d5e49503a7e0d9a00b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error status code returned by <a class="el" href="_n_v_s_8h.html#a4f309d160ac4641c89501adc95d170b3" title="Erase &#39;size&#39; bytes of the region beginning at &#39;offset&#39; bytes from the base of the region referenced b...">NVS_erase()</a>, <a class="el" href="_n_v_s_8h.html#aae7abe0cb889a6d0cc1858bfc69ab7e0" title="Write data to an NVS region. ">NVS_write()</a>.  <a href="#aa21de44fea696d5e49503a7e0d9a00b7">More...</a><br /></td></tr>
<tr class="separator:aa21de44fea696d5e49503a7e0d9a00b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a38491f6eb4860eab3549daf9ad4c273a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_n_v_s_c_c26_x_x___h_w_attrs.html">NVSCC26XX_HWAttrs</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_n_v_s_c_c26_x_x_8h.html#a38491f6eb4860eab3549daf9ad4c273a">NVSCC26XX_HWAttrs</a></td></tr>
<tr class="memdesc:a38491f6eb4860eab3549daf9ad4c273a"><td class="mdescLeft">&#160;</td><td class="mdescRight">NVSCC26XX attributes.  <a href="#a38491f6eb4860eab3549daf9ad4c273a">More...</a><br /></td></tr>
<tr class="separator:a38491f6eb4860eab3549daf9ad4c273a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008a277378544c3ce2b65a2e9688d49e"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_n_v_s_c_c26_x_x___object.html">NVSCC26XX_Object</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_n_v_s_c_c26_x_x_8h.html#a008a277378544c3ce2b65a2e9688d49e">NVSCC26XX_Object</a></td></tr>
<tr class="separator:a008a277378544c3ce2b65a2e9688d49e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ade3114c185df6a15ec62305dd5c6f6cc"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="struct_n_v_s___fxn_table.html">NVS_FxnTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_n_v_s_c_c26_x_x_8h.html#ade3114c185df6a15ec62305dd5c6f6cc">NVSCC26XX_fxnTable</a></td></tr>
<tr class="separator:ade3114c185df6a15ec62305dd5c6f6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa21de44fea696d5e49503a7e0d9a00b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21de44fea696d5e49503a7e0d9a00b7">&sect;&nbsp;</a></span>NVSCC26XX_STATUS_LOW_VOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NVSCC26XX_STATUS_LOW_VOLTAGE&#160;&#160;&#160;(<a class="el" href="group___n_v_s___c_o_n_t_r_o_l.html#gad82fd139152ca14946c80c6c91edb4a0">NVS_STATUS_RESERVED</a> - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error status code returned by <a class="el" href="_n_v_s_8h.html#a4f309d160ac4641c89501adc95d170b3" title="Erase &#39;size&#39; bytes of the region beginning at &#39;offset&#39; bytes from the base of the region referenced b...">NVS_erase()</a>, <a class="el" href="_n_v_s_8h.html#aae7abe0cb889a6d0cc1858bfc69ab7e0" title="Write data to an NVS region. ">NVS_write()</a>. </p>
<p>This error status is returned if the system voltage is too low to safely perform the flash operation. Voltage must be 1.5V or greater. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a38491f6eb4860eab3549daf9ad4c273a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38491f6eb4860eab3549daf9ad4c273a">&sect;&nbsp;</a></span>NVSCC26XX_HWAttrs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_n_v_s_c_c26_x_x___h_w_attrs.html">NVSCC26XX_HWAttrs</a>  <a class="el" href="struct_n_v_s_c_c26_x_x___h_w_attrs.html">NVSCC26XX_HWAttrs</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NVSCC26XX attributes. </p>
<p>The 'regionBase' field must point to the base address of the region to be managed.</p>
<p>The regionSize must be an integer multiple of the flash sector size. For most CC26XX/CC13XX devices, the flash sector size is 4096 bytes. The NVSCC26XX driver will determine the device's actual sector size by reading internal system configuration registers.</p>
<p>Care must be taken to ensure that the linker does not unintentionally place application content (e.g., code/data) in the flash regions.</p>
<p>For CCS and IAR tools, defining and reserving flash memory regions can be done entirely within the Board.c file. For GCC, additional content is required in the application's linker command file to achieve the same result.</p>
<p>The example below defines a char array, 'flashBuf' and uses compiler CCS and IAR compiler pragmas to place 'flashBuf' at a specific address within the flash memory.</p>
<p>For GCC, the 'flashBuf' array is placed into a named linker section. Corresponding linker commands are added to the application's linker command file to place the section at a specific flash memory address. The section placement command is carefully chosen to only RESERVE space for the 'flashBuf' array, and not to actually initialize it during the application load process, thus preserving the content of flash.</p>
<p>The 'regionBase' fields of the two HWAttrs region instances are initialized to point to the base address of 'flashBuf' and to some offset from the base of the char array.</p>
<p>The linker command syntax is carefully chosen to only RESERVE space for the char array and not to actually initialize it during application load.</p>
<div class="fragment"><div class="line"><span class="preprocessor"> #define SECTORSIZE 0x1000</span></div><div class="line"><span class="preprocessor"> #define FLASH_REGION_BASE 0x1b000</span></div><div class="line"></div><div class="line"> <span class="comment">//</span></div><div class="line"> <span class="comment">// Reserve flash sectors for NVS driver use</span></div><div class="line"> <span class="comment">// by placing an uninitialized byte array</span></div><div class="line"> <span class="comment">// at the desired flash address.</span></div><div class="line"> <span class="comment">//</span></div><div class="line"><span class="preprocessor"> #if defined(__TI_COMPILER_VERSION__)</span></div><div class="line"></div><div class="line"> <span class="comment">//</span></div><div class="line"> <span class="comment">//  Place uninitialized array at FLASH_REGION_BASE</span></div><div class="line"> <span class="comment">//</span></div><div class="line"><span class="preprocessor"> #pragma LOCATION(flashBuf, FLASH_REGION_BASE);</span></div><div class="line"><span class="preprocessor"> #pragma NOINIT(flashBuf);</span></div><div class="line"> <span class="keywordtype">char</span> flashBuf[SECTORSIZE * 4];</div><div class="line"></div><div class="line"><span class="preprocessor"> #elif defined(__IAR_SYSTEMS_ICC__)</span></div><div class="line"></div><div class="line"> <span class="comment">//</span></div><div class="line"> <span class="comment">//  Place uninitialized array at FLASH_REGION_BASE</span></div><div class="line"> <span class="comment">//</span></div><div class="line"> __no_init <span class="keywordtype">char</span> flashBuf[SECTORSIZE * 4] @ FLASH_REGION_BASE;</div><div class="line"></div><div class="line"><span class="preprocessor"> #elif defined(__GNUC__)</span></div><div class="line"></div><div class="line"></div><div class="line"> <span class="comment">//</span></div><div class="line"> <span class="comment">//  Place the flash buffers in the .nvs section created in the gcc linker file.</span></div><div class="line"> <span class="comment">//  The .nvs section enforces alignment on a sector boundary but may</span></div><div class="line"> <span class="comment">//  be placed anywhere in flash memory.  If desired the .nvs section can be set</span></div><div class="line"> <span class="comment">//  to a fixed address by changing the following in the gcc linker file:</span></div><div class="line"></div><div class="line">.nvs (FIXED_FLASH_ADDR) (NOLOAD) : AT (FIXED_FLASH_ADDR) {</div><div class="line">     *(.nvs)</div><div class="line">} &gt; REGION_TEXT</div><div class="line"></div><div class="line"> __attribute__ ((section (<span class="stringliteral">&quot;.nvs&quot;</span>)))</div><div class="line"> <span class="keywordtype">char</span> flashBuf[SECTORSIZE * 4];</div><div class="line"></div><div class="line"><span class="preprocessor"> #endif</span></div><div class="line"></div><div class="line"> <a class="code" href="struct_n_v_s_c_c26_x_x___h_w_attrs.html">NVSCC26XX_HWAttrs</a> nvsCC26XXHWAttrs[2] = {</div><div class="line">     <span class="comment">//</span></div><div class="line">     <span class="comment">// region 0 is 1 flash sector in length.</span></div><div class="line">     <span class="comment">//</span></div><div class="line">     {</div><div class="line">         .<a class="code" href="struct_n_v_s_c_c26_x_x___h_w_attrs.html#ad5ee322e543d49b4c177f28f4e96f884">regionBase</a> = (<span class="keywordtype">void</span> *)flashBuf,</div><div class="line">         .regionSize = SECTORSIZE,</div><div class="line">     },</div><div class="line">     <span class="comment">//</span></div><div class="line">     <span class="comment">// region 1 is 3 flash sectors in length.</span></div><div class="line">     <span class="comment">//</span></div><div class="line">     {</div><div class="line">         .regionBase = (<span class="keywordtype">void</span> *)(flashBuf + SECTORSIZE),</div><div class="line">         .regionSize = SECTORSIZE*3,</div><div class="line">     }</div><div class="line"> };</div><div class="line"></div><div class="line"> Example GCC linker command file content reserves flash space</div><div class="line"> but does not initialize it:</div><div class="line"></div><div class="line"> MEMORY</div><div class="line"> {</div><div class="line">     FLASH (RX)      : ORIGIN = 0x00000000, LENGTH = 0x0001ffa8</div><div class="line">     FLASH_CCFG (RX) : ORIGIN = 0x0001ffa8, LENGTH = 0x00000058</div><div class="line">     SRAM (RWX)      : ORIGIN = 0x20000000, LENGTH = 0x00005000</div><div class="line"> }</div><div class="line"></div><div class="line"> .nvs (0x1b000) (NOLOAD) : AT (0x1b000) {</div><div class="line">     *(.nvs)</div><div class="line"> } &gt; NVS</div></div><!-- fragment --> 
</div>
</div>
<a id="a008a277378544c3ce2b65a2e9688d49e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a008a277378544c3ce2b65a2e9688d49e">&sect;&nbsp;</a></span>NVSCC26XX_Object</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_n_v_s_c_c26_x_x___object.html">NVSCC26XX_Object</a>  <a class="el" href="struct_n_v_s_c_c26_x_x___object.html">NVSCC26XX_Object</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ade3114c185df6a15ec62305dd5c6f6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade3114c185df6a15ec62305dd5c6f6cc">&sect;&nbsp;</a></span>NVSCC26XX_fxnTable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="struct_n_v_s___fxn_table.html">NVS_FxnTable</a> NVSCC26XX_fxnTable</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><small>
Copyright  2017, Texas Instruments Incorporated
</small>
</body>
</html>
